# 项目：平方反比引力场中的运动 - 实验报告

**学生姓名：** 滕欣玥
**学号：** 20221050199
**完成日期：** 2025.6.4

## 1. 实验目的

通过数值模拟研究不同总能量（E < 0, E ≈ 0, E > 0）和不同角动量条件下质点在平方反比引力场中的运动轨道特性，进一步验证能量与角动量守恒定律，并理解它们对轨道形状的决定性影响。


## 2. 核心算法与实现

### 2.1 运动方程与数值方法

本实验基于平方反比引力场，即万有引力作用下的中心力场模型。运动方程组（极坐标形式）为：

$$
\begin{cases}
\frac{d^2r}{dt^2}= r\left(\frac{d\theta}{dt}\right)^2-\frac{GM}{r^2}\\
\frac{d^2\theta}{dt^2} = -\frac{2}{r}\frac{dr}{dt}\frac{d\theta}{dt}
\end{cases}
$$

 为了进行数值求解，我们需要将上述二阶常微分方程组转换为一阶常微分方程组。令：

*   $y_0 = r$
*   $y_1 = \frac{dr}{dt} = \dot{r}$
*   $y_2 = \theta$
*   $y_3 = \frac{d\theta}{dt} = \dot{\theta}$

则一阶方程组为：

$$
\begin{cases}
\frac{dy_0}{dt} = y_1 \\
\frac{dy_1}{dt} = y_0 y_3^2 - \frac{GM}{y_0^2} \\
\frac{dy_2}{dt} = y_3 \\
\frac{dy_3}{dt} = -\frac{2 y_1 y_3}{y_0}
\end{cases}
$$
 
 采用 scipy.integrate.solve_ivp 函数进行数值求解，使用默认的 Runge-Kutta 4(5)（RK45）方法，时间步长在 t_eval 中通过 linspace 均匀设定。

### 2.2 关键函数实现思路
（选择1-2个你认为最核心的函数，例如 `derivatives` 或 `solve_orbit`，用3-5句话描述其实现思路和关键步骤。）

#### `[函数名1]` 实现思路：

```python
def derivatives(t, state, GM):
    x, y, vx, vy = state
    r = np.sqrt(x**2 + y**2)
    ax = -GM * x / r**3
    ay = -GM * y / r**3
    return [vx, vy, ax, ay]
```
该函数定义了质点在平方反比引力场中的加速度表达式，将位置和速度向量拼接后的状态数组转换为导数形式，供 solve_ivp 调用。

#### `[函数名2]` 实现思路：

```python
def solve_orbit(initial_state, t_span, t_eval, gm_val=1.0):
    return solve_ivp(
        fun=lambda t, y: derivatives(t, y, gm_val),
        t_span=t_span,
        y0=initial_state,
        t_eval=t_eval,
        method='RK45'
    )
```
此函数负责调用 solve_ivp 对运动方程进行数值积分。它接受初始状态、积分时间范围、时间点数组及 GM 参数，返回包含时间序列和对应状态的 OdeSolution 对象。

## 3. 实验结果与分析

### 3.1 不同总能量下的轨道

![image](https://github.com/user-attachments/assets/045b2d27-a950-49eb-9781-c1539a3ca672)

**图1：不同能量下的轨道图 (E<0, E=0, E>0)**

```
[如果无法直接嵌入图像，请在此处描述图像内容，并指明图像文件名，例如：
 图像展示了在相同初始位置下（x=1, y=0），通过改变速度大小使得总能量分别小于、等于、或大于零，所形成的三类轨道：
 - 椭圆轨道 (E = [-0.68]): [质点围绕中心天体作闭合轨道运动。]
 - 抛物线轨道 (E = [0]): [轨道无限延伸但不会返回，接近开放轨道边界情况]
 - 双曲线轨道 (E = [0.625]): [轨道无限延伸但不会返回，接近开放轨道边界情况]
 中心天体位于原点。
 图像文件名：energy_orbits.png (示例)
]
```

**结果分析：**

E < 0：束缚轨道，形成椭圆。

E = 0：临界逃逸，形成抛物线。

E > 0：非束缚轨道，形成双曲线。

轨道形状由机械能（动能与势能之和）决定，能量守恒在模拟过程中保持良好。

**(可选) 能量与角动量守恒验证：**



### 3.2 不同角动量下的椭圆轨道 (E < 0)

![image](https://github.com/user-attachments/assets/afdb3130-7b6a-4f63-968c-7680096fb4d6)


**图2：固定能量 (E=[具体值])，不同角动量下的椭圆轨道**

```
[如果无法直接嵌入图像，请在此处描述图像内容，并指明图像文件名，例如：
 图像显示了能量 E=[-0.5] 时，三个不同角动量 L1, L2, L3 下的椭圆轨道。
 - L1 = [0.5]: [v ≈ 2.0，L ≈ 1.0，轨道偏心率较大，轨道更“尖锐”。]
 - L2 = [0.7]: [v ≈ 1.43，L ≈ 1.0，轨道稍圆。]
 - L3 = [1]: [v ≈ 1.0，L ≈ 1.0，轨道趋近圆形。]
 图像文件名：angular_momentum_orbits.png (示例)
]
```

**结果分析：**

角动量越大，轨道的偏心率越小，越接近圆形；角动量小则轨道越“扁平”或“拉长”。这体现了角动量对轨道形状（尤其是轨道面上点速方向变化）的决定性影响。所有情况能量恒为负，轨道均为椭圆。

## 4. 问题与收获

### 4.1遇到的主要问题及解决方法
（列出你在完成项目中遇到的1-2个主要困难或挑战，并说明你是如何思考和解决这些问题的。）

**问题1：** [ 解算器 solve_ivp 的时间跨度选择影响轨道完整性。]
**解决方法：** [调整 t_end 和 t_eval 使轨道运行周期完整，并避免轨道被“截断”。]


### 4.2 主要收获与体会

更深入理解了轨道形状如何由能量与角动量决定；

掌握了如何将物理模型转化为一阶微分方程并使用 Python 数值积分求解；

提升了使用 matplotlib 进行轨道可视化与数据分析的能力；

感受到数值误差在守恒量验证中所带来的影响与挑战。

### 5.1 坐标转换与对称性

我们在笛卡尔坐标下数值模拟得到的轨道图形（如椭圆轨道关于主轴对称，双曲线关于渐近线对称等），在极坐标表达中更容易从数学形式直接看出。若将数值模拟结果转换为极坐标绘图（即将每个点转换为 (r, θ)），可以更清晰地观察这种对称性，并验证轨道方程的理论推导。

此外，由于平方反比力是保守中心力，它天然满足：

角动量守恒：轨道面固定，运动轨迹关于中心天体对称

时间反演对称性：若反向运行时间，轨道形状不变

这些对称性不仅在理论推导中成立，也能在我们的数值模拟轨道图中得到体现。

![image](https://github.com/user-attachments/assets/f5fe6d38-1b0e-42f3-bf5d-d0c9fece3683)

为了更清晰地分析轨道的对称性结构，我们将轨道从笛卡尔坐标系 (x,y) 转换到极坐标系 (r,θ)，并绘制了 r 相对于 θ 的图像。

从图中可以观察到以下特点：

椭圆轨道（E<0） 的 r(θ) 轨迹是一个闭合曲线，展现出关于近地点和远地点的对称性，且在极坐标图中形状接近玫瑰线。

抛物线轨道（E≈0） 的 r(θ) 图像呈现一个开口的结构，轨道从近地点起持续远离中心天体，说明是临界逃逸轨道。

双曲线轨道（E>0） 的极坐标轨迹同样为开口曲线，并展现出远离中心天体的对称张开形态。

极坐标图有助于直观展示轨道是否闭合，以及轨道随角度的对称性情况。例如，在理想平方反比力场中，轨道应具有关于某一轴线的镜像对称性，这在 r(θ) 图中表现为关于某一角度对称的曲线。

这一分析也印证了轨道的开闭性主要由总能量决定，而轨道的“形状”（如扁平程度）则更多由角动量控制。

### 5.2 其他思考

本模型假设中心天体不动，未考虑质点反作用；

可拓展至三维运动、加入扰动项、模拟多天体问题；

可考虑与真实天体轨道（如彗星、行星）做对比分析。
